
[import "cas"]
[import "test"]

[TestEq "rm0" [+ x] *x [rm0 [+ 0 x] *x]]
[TestFails "rm0 fails" [rm0 [+ x] *]]
[TestEq "apply rm0" [+ x y] *x [apply [+ x 0 y] *x [rm0]]]
[TestEq "apply nested rm0" [+ x [+ a b] y] *x [apply [+ x [+ a 0 b] y] *x [rm0]]]

[TestEq "apply nested rm1" [+ x [~ 4 [^ x [~ pi]]]] *x [apply [+ x [~ 4 [^ x [~ pi 1]]]] *x [rm1]]]
[TestFails "apply rm1 to addition" [apply [+ x y 1] * [rm1]]]

[TestEq "sort multiplications" [~ 1 2 3 [^ a n] x y z] *x [exhaust [~ x 1 y 2 [^ a n] 3 z] *x [srt]]]

[TestEq "Remove nested vectors" [+ 1 2 3 4 5] *x [exhaust [+ 1 [+ 2 [+ 3 4]] 5] *x [rdb]]]
[TestEq "Remove nested products" [+ 1 2 x 4 5] *x [exhaust [+ 1 [+ 2 [~ x 1]] 4 5] *x [rdb srt rm1 rdb]]]

[TestEq "Reduce numbers" [+ [~ 15 x]] *x [exhaust [+ [~ 3 x 5]] *x [rdn srt]]]
[TestEq "Reduce numbers completely" [+ x] *x [exhaust [+ [~ 2 x 0.5]] *x [rdn srt rm1 rdb]]]

[TestEq "Distribution 1" [+ [~ 2 v x] [~ 2 v y]] *x [exhaust [+ [~ 2 [+ x y] v]] *x [dstr rdb srt]]]

[TestEq "Two distributions" [+ [~ 4 [^ x 3]] [~ 24 [^ x 2]] [~ 20 x]] *x [exhaust [+ [~ x 4 [+ x 1] [+ x 5]]] *x [rdb srt dstr rdn rm1 clt pwr]]]

[FailedTestSummary]

;[command]

[exit]

